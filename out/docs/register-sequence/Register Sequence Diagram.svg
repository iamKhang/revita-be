<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3606px" preserveAspectRatio="none" style="width:1966px;height:3606px;background:#FFFFFF;" version="1.1" viewBox="0 0 1966 3606" width="1966px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="864.9175" style="stroke:#000000;stroke-width:1.0;" width="1934.5" x="25" y="356.4092"/><rect fill="#FFFFFF" height="269.5625" style="stroke:#000000;stroke-width:1.0;" width="613.5" x="911" y="703.2017"/><rect fill="#FFFFFF" height="133.5659" style="stroke:none;stroke-width:1.0;" width="613.5" x="911" y="839.1982"/><rect fill="#FFFFFF" height="120.5659" style="stroke:none;stroke-width:1.0;" width="1934.5" x="25" y="1100.7607"/><rect fill="#FFFFFF" height="495.7563" style="stroke:#000000;stroke-width:1.0;" width="1934.5" x="25" y="1609.9185"/><rect fill="#FFFFFF" height="120.5659" style="stroke:none;stroke-width:1.0;" width="1934.5" x="25" y="1985.1089"/><rect fill="#FFFFFF" height="1131.1113" style="stroke:#000000;stroke-width:1.0;" width="1938.5" x="15" y="2376.0693"/><rect fill="#FFFFFF" height="860.5488" style="stroke:#000000;stroke-width:1.0;" width="1918.5" x="25" y="2519.0659"/><rect fill="#FFFFFF" height="120.5659" style="stroke:none;stroke-width:1.0;" width="1918.5" x="25" y="3259.0488"/><rect fill="#FFFFFF" height="120.5659" style="stroke:none;stroke-width:1.0;" width="1938.5" x="15" y="3386.6147"/><line style="stroke:#000000;stroke-width:1.0;" x1="53" x2="53" y1="83.0146" y2="3524.1807"/><line style="stroke:#000000;stroke-width:1.0;" x1="389" x2="389" y1="83.0146" y2="3524.1807"/><line style="stroke:#000000;stroke-width:1.0;" x1="680" x2="680" y1="83.0146" y2="3524.1807"/><line style="stroke:#000000;stroke-width:1.0;" x1="978" x2="978" y1="83.0146" y2="3524.1807"/><line style="stroke:#000000;stroke-width:1.0;" x1="1219.5" x2="1219.5" y1="83.0146" y2="3524.1807"/><line style="stroke:#000000;stroke-width:1.0;" x1="1374.5" x2="1374.5" y1="83.0146" y2="3524.1807"/><line style="stroke:#000000;stroke-width:1.0;" x1="1519.5" x2="1519.5" y1="83.0146" y2="3524.1807"/><line style="stroke:#000000;stroke-width:1.0;" x1="1684" x2="1684" y1="83.0146" y2="3524.1807"/><line style="stroke:#000000;stroke-width:1.0;" x1="1854.5" x2="1854.5" y1="83.0146" y2="3524.1807"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="31" x="35" y="80.0752">User</text><ellipse cx="53.5" cy="14" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1.0;"/><path d="M53.5,22 L53.5,49 M40.5,30 L66.5,30 M53.5,49 L40.5,64 M53.5,49 L66.5,64 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="31" x="35" y="3537.2559">User</text><ellipse cx="53.5" cy="3549.1953" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1.0;"/><path d="M53.5,3557.1953 L53.5,3584.1953 M40.5,3565.1953 L66.5,3565.1953 M53.5,3584.1953 L40.5,3599.1953 M53.5,3584.1953 L66.5,3599.1953 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="63" x="355" y="80.0752">Frontend</text><path d="M369,38 L369,62 M369,50 L386,50 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="398" cy="50" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="63" x="355" y="3537.2559">Frontend</text><path d="M369,3544.1953 L369,3568.1953 M369,3556.1953 L386,3556.1953 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="398" cy="3556.1953" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="127" x="614" y="80.0752">RegisterController</text><ellipse cx="680.5" cy="50" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="676.5,38,682.5,33,680.5,38,682.5,43,676.5,38" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="127" x="614" y="3537.2559">RegisterController</text><ellipse cx="680.5" cy="3556.1953" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="676.5,3544.1953,682.5,3539.1953,680.5,3544.1953,682.5,3549.1953,676.5,3544.1953" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="109" x="921" y="80.0752">RegisterService</text><ellipse cx="978.5" cy="50" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="974.5,38,980.5,33,978.5,38,980.5,43,974.5,38" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="109" x="921" y="3537.2559">RegisterService</text><ellipse cx="978.5" cy="3556.1953" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="974.5,3544.1953,980.5,3539.1953,978.5,3544.1953,980.5,3549.1953,974.5,3544.1953" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="90" x="1171.5" y="80.0752">EmailService</text><ellipse cx="1219.5" cy="50" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1207.5" x2="1231.5" y1="64" y2="64"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="90" x="1171.5" y="3537.2559">EmailService</text><ellipse cx="1219.5" cy="3556.1953" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1207.5" x2="1231.5" y1="3570.1953" y2="3570.1953"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="82" x="1330.5" y="80.0752">SmsService</text><ellipse cx="1374.5" cy="50" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1362.5" x2="1386.5" y1="64" y2="64"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="82" x="1330.5" y="3537.2559">SmsService</text><ellipse cx="1374.5" cy="3556.1953" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1362.5" x2="1386.5" y1="3570.1953" y2="3570.1953"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="56" x="1488.5" y="80.0752">Account</text><ellipse cx="1519.5" cy="50" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1507.5" x2="1531.5" y1="64" y2="64"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="56" x="1488.5" y="3537.2559">Account</text><ellipse cx="1519.5" cy="3556.1953" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1507.5" x2="1531.5" y1="3570.1953" y2="3570.1953"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="49" x="1657" y="80.0752">Patient</text><ellipse cx="1684.5" cy="50" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1672.5" x2="1696.5" y1="64" y2="64"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="49" x="1657" y="3537.2559">Patient</text><ellipse cx="1684.5" cy="3556.1953" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1672.5" x2="1696.5" y1="3570.1953" y2="3570.1953"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="38" x="1832.5" y="80.0752">Redis</text><ellipse cx="1854.5" cy="50" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1842.5" x2="1866.5" y1="64" y2="64"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="38" x="1832.5" y="3537.2559">Redis</text><ellipse cx="1854.5" cy="3556.1953" fill="#FFFFFF" rx="12" ry="12" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1842.5" x2="1866.5" y1="3570.1953" y2="3570.1953"/><polygon fill="#000000" points="377.5,110.814,387.5,114.814,377.5,118.814,381.5,114.814" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="53.5" x2="383.5" y1="114.814" y2="114.814"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="141" x="60.5" y="110.0845">Enter phone or email</text><polygon fill="#000000" points="668.5,143.6133,678.5,147.6133,668.5,151.6133,672.5,147.6133" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="389.5" x2="674.5" y1="147.6133" y2="147.6133"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="140" x="396.5" y="142.8838">POST /register/step1</text><path d="M685,127.814 L685,152.814 L784,152.814 L784,137.814 L774,127.814 L685,127.814 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M774,127.814 L774,137.814 L784,137.814 L774,127.814 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="78" x="691" y="145.8838">RegisterDto</text><line style="stroke:#000000;stroke-width:1.0;" x1="680.5" x2="722.5" y1="180.4126" y2="180.4126"/><line style="stroke:#000000;stroke-width:1.0;" x1="722.5" x2="722.5" y1="180.4126" y2="193.4126"/><line style="stroke:#000000;stroke-width:1.0;" x1="681.5" x2="722.5" y1="193.4126" y2="193.4126"/><polygon fill="#000000" points="691.5,189.4126,681.5,193.4126,691.5,197.4126,687.5,193.4126" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="164" x="687.5" y="175.6831">validateRegisterDto(dto)</text><polygon fill="#000000" points="966.5,219.2119,976.5,223.2119,966.5,227.2119,970.5,223.2119" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="680.5" x2="972.5" y1="223.2119" y2="223.2119"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="177" x="687.5" y="218.4824">registerStep1(registerDto)</text><polygon fill="#000000" points="1507.5,249.0112,1517.5,253.0112,1507.5,257.0112,1511.5,253.0112" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1513.5" y1="253.0112" y2="253.0112"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="275" x="985.5" y="248.2817">checkPhoneOrEmailExists(phoneOrEmail)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1519.5" x2="1561.5" y1="282.8105" y2="282.8105"/><line style="stroke:#000000;stroke-width:1.0;" x1="1561.5" x2="1561.5" y1="282.8105" y2="295.8105"/><line style="stroke:#000000;stroke-width:1.0;" x1="1520.5" x2="1561.5" y1="295.8105" y2="295.8105"/><polygon fill="#000000" points="1530.5,291.8105,1520.5,295.8105,1530.5,299.8105,1526.5,295.8105" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151" x="1526.5" y="278.0811">prisma.auth.findFirst()</text><polygon fill="#000000" points="989.5,337.4092,979.5,341.4092,989.5,345.4092,985.5,341.4092" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1518.5" y1="341.4092" y2="341.4092"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82" x="995.5" y="320.8804">existingAuth</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="225" x="995.5" y="336.6797">(account if exists, null otherwise)</text><path d="M25,356.4092 L89,356.4092 L89,364.2085 L79,374.2085 L25,374.2085 L25,356.4092 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="864.9175" style="stroke:#000000;stroke-width:1.0;" width="1934.5" x="25" y="356.4092"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="40" y="370.479">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="159" x="104" y="369.4683">[Phone/email not exists]</text><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1020.5" y1="396.0078" y2="396.0078"/><line style="stroke:#000000;stroke-width:1.0;" x1="1020.5" x2="1020.5" y1="396.0078" y2="409.0078"/><line style="stroke:#000000;stroke-width:1.0;" x1="979.5" x2="1020.5" y1="409.0078" y2="409.0078"/><polygon fill="#000000" points="989.5,405.0078,979.5,409.0078,989.5,413.0078,985.5,409.0078" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="97" x="985.5" y="391.2783">generateOTP()</text><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1020.5" y1="438.8071" y2="438.8071"/><line style="stroke:#000000;stroke-width:1.0;" x1="1020.5" x2="1020.5" y1="438.8071" y2="451.8071"/><line style="stroke:#000000;stroke-width:1.0;" x1="979.5" x2="1020.5" y1="451.8071" y2="451.8071"/><polygon fill="#000000" points="989.5,447.8071,979.5,451.8071,989.5,455.8071,985.5,451.8071" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="135" x="985.5" y="434.0776">generateSessionId()</text><polygon fill="#000000" points="1842.5,477.6064,1852.5,481.6064,1842.5,485.6064,1846.5,481.6064" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1848.5" y1="481.6064" y2="481.6064"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="277" x="985.5" y="476.877">saveSessionData(sessionId, sessionData)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1854.5" x2="1896.5" y1="511.4058" y2="511.4058"/><line style="stroke:#000000;stroke-width:1.0;" x1="1896.5" x2="1896.5" y1="511.4058" y2="524.4058"/><line style="stroke:#000000;stroke-width:1.0;" x1="1855.5" x2="1896.5" y1="524.4058" y2="524.4058"/><polygon fill="#000000" points="1865.5,520.4058,1855.5,524.4058,1865.5,528.4058,1861.5,524.4058" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="86" x="1861.5" y="506.6763">redis.setex()</text><polygon fill="#000000" points="989.5,566.0044,979.5,570.0044,989.5,574.0044,985.5,570.0044" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1853.5" y1="570.0044" y2="570.0044"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="51" x="995.5" y="549.4756">success</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="231" x="995.5" y="565.2749">(session saved with 15min expiry)</text><polygon fill="#000000" points="1842.5,595.8037,1852.5,599.8037,1842.5,603.8037,1846.5,599.8037" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1848.5" y1="599.8037" y2="599.8037"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="227" x="985.5" y="595.0742">saveOTP(phoneOrEmail, otp, 300)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1854.5" x2="1896.5" y1="629.603" y2="629.603"/><line style="stroke:#000000;stroke-width:1.0;" x1="1896.5" x2="1896.5" y1="629.603" y2="642.603"/><line style="stroke:#000000;stroke-width:1.0;" x1="1855.5" x2="1896.5" y1="642.603" y2="642.603"/><polygon fill="#000000" points="1865.5,638.603,1855.5,642.603,1865.5,646.603,1861.5,642.603" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="86" x="1861.5" y="624.8735">redis.setex()</text><polygon fill="#000000" points="989.5,684.2017,979.5,688.2017,989.5,692.2017,985.5,688.2017" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1853.5" y1="688.2017" y2="688.2017"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="51" x="995.5" y="667.6729">success</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="200" x="995.5" y="683.4722">(OTP saved with 5min expiry)</text><path d="M911,703.2017 L975,703.2017 L975,711.001 L965,721.001 L911,721.001 L911,703.2017 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="269.5625" style="stroke:#000000;stroke-width:1.0;" width="613.5" x="911" y="703.2017"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="926" y="717.2715">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="78" x="990" y="716.2607">[Has phone]</text><polygon fill="#000000" points="1362.5,738.8003,1372.5,742.8003,1362.5,746.8003,1366.5,742.8003" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1368.5" y1="742.8003" y2="742.8003"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143" x="985.5" y="738.0708">sendSMS(phone, otp)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1374.5" x2="1416.5" y1="772.5996" y2="772.5996"/><line style="stroke:#000000;stroke-width:1.0;" x1="1416.5" x2="1416.5" y1="772.5996" y2="785.5996"/><line style="stroke:#000000;stroke-width:1.0;" x1="1375.5" x2="1416.5" y1="785.5996" y2="785.5996"/><polygon fill="#000000" points="1385.5,781.5996,1375.5,785.5996,1385.5,789.5996,1381.5,785.5996" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="131" x="1381.5" y="767.8701">smsProvider.send()</text><polygon fill="#000000" points="989.5,827.1982,979.5,831.1982,989.5,835.1982,985.5,831.1982" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1373.5" y1="831.1982" y2="831.1982"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="38" x="995.5" y="810.6694">result</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="163" x="995.5" y="826.4688">(SMS sent confirmation)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="911" x2="1524.5" y1="840.1982" y2="840.1982"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="73" x="916" y="851.2573">[Has email]</text><polygon fill="#000000" points="1207.5,872.3662,1217.5,876.3662,1207.5,880.3662,1211.5,876.3662" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1213.5" y1="876.3662" y2="876.3662"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="148" x="985.5" y="871.6367">sendEmail(email, otp)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1219.5" x2="1261.5" y1="906.1655" y2="906.1655"/><line style="stroke:#000000;stroke-width:1.0;" x1="1261.5" x2="1261.5" y1="906.1655" y2="919.1655"/><line style="stroke:#000000;stroke-width:1.0;" x1="1220.5" x2="1261.5" y1="919.1655" y2="919.1655"/><polygon fill="#000000" points="1230.5,915.1655,1220.5,919.1655,1230.5,923.1655,1226.5,919.1655" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="141" x="1226.5" y="901.436">emailProvider.send()</text><polygon fill="#000000" points="989.5,960.7642,979.5,964.7642,989.5,968.7642,985.5,964.7642" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1218.5" y1="964.7642" y2="964.7642"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="38" x="995.5" y="944.2354">result</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="171" x="995.5" y="960.0347">(email sent confirmation)</text><polygon fill="#000000" points="691.5,1013.3628,681.5,1017.3628,691.5,1021.3628,687.5,1017.3628" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="685.5" x2="977.5" y1="1017.3628" y2="1017.3628"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="60" x="697.5" y="996.834">response</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="231" x="697.5" y="1012.6333">(sessionId and OTP sent message)</text><polygon fill="#000000" points="400.5,1058.9614,390.5,1062.9614,400.5,1066.9614,396.5,1062.9614" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394.5" x2="679.5" y1="1062.9614" y2="1062.9614"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="60" x="406.5" y="1042.4326">response</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="95" x="406.5" y="1058.2319">(session data)</text><polygon fill="#000000" points="64.5,1088.7607,54.5,1092.7607,64.5,1096.7607,60.5,1092.7607" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58.5" x2="388.5" y1="1092.7607" y2="1092.7607"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="177" x="70.5" y="1088.0313">Display OTP sent message</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="25" x2="1959.5" y1="1101.7607" y2="1101.7607"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="134" x="30" y="1112.8198">[Phone/email exists]</text><polygon fill="#000000" points="691.5,1133.9287,681.5,1137.9287,691.5,1141.9287,687.5,1137.9287" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="685.5" x2="977.5" y1="1137.9287" y2="1137.9287"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169" x="697.5" y="1133.1992">throw ConflictException()</text><polygon fill="#000000" points="400.5,1179.5273,390.5,1183.5273,400.5,1187.5273,396.5,1183.5273" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394.5" x2="679.5" y1="1183.5273" y2="1183.5273"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="34" x="406.5" y="1162.9985">error</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="199" x="406.5" y="1178.7979">(already registered message)</text><polygon fill="#000000" points="64.5,1209.3267,54.5,1213.3267,64.5,1217.3267,60.5,1213.3267" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58.5" x2="388.5" y1="1213.3267" y2="1213.3267"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="241" x="70.5" y="1208.5972">Display already registered message</text><polygon fill="#000000" points="377.5,1246.126,387.5,1250.126,377.5,1254.126,381.5,1250.126" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="53.5" x2="383.5" y1="1250.126" y2="1250.126"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="102" x="60.5" y="1245.3965">Enter OTP code</text><polygon fill="#000000" points="668.5,1278.9253,678.5,1282.9253,668.5,1286.9253,672.5,1282.9253" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="389.5" x2="674.5" y1="1282.9253" y2="1282.9253"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="170" x="396.5" y="1278.1958">POST /register/verify-otp</text><path d="M685,1263.126 L685,1288.126 L792,1288.126 L792,1273.126 L782,1263.126 L685,1263.126 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M782,1263.126 L782,1273.126 L792,1273.126 L782,1263.126 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="86" x="691" y="1281.1958">VerifyOtpDto</text><line style="stroke:#000000;stroke-width:1.0;" x1="680.5" x2="722.5" y1="1315.7246" y2="1315.7246"/><line style="stroke:#000000;stroke-width:1.0;" x1="722.5" x2="722.5" y1="1315.7246" y2="1328.7246"/><line style="stroke:#000000;stroke-width:1.0;" x1="681.5" x2="722.5" y1="1328.7246" y2="1328.7246"/><polygon fill="#000000" points="691.5,1324.7246,681.5,1328.7246,691.5,1332.7246,687.5,1328.7246" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="149" x="687.5" y="1310.9951">validateVerifyDto(dto)</text><polygon fill="#000000" points="966.5,1354.5239,976.5,1358.5239,966.5,1362.5239,970.5,1358.5239" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="680.5" x2="972.5" y1="1358.5239" y2="1358.5239"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="136" x="687.5" y="1353.7944">verifyOtp(verifyDto)</text><polygon fill="#000000" points="1842.5,1384.3232,1852.5,1388.3232,1842.5,1392.3232,1846.5,1388.3232" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1848.5" y1="1388.3232" y2="1388.3232"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="177" x="985.5" y="1383.5938">getSessionData(sessionId)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1854.5" x2="1896.5" y1="1418.1226" y2="1418.1226"/><line style="stroke:#000000;stroke-width:1.0;" x1="1896.5" x2="1896.5" y1="1418.1226" y2="1431.1226"/><line style="stroke:#000000;stroke-width:1.0;" x1="1855.5" x2="1896.5" y1="1431.1226" y2="1431.1226"/><polygon fill="#000000" points="1865.5,1427.1226,1855.5,1431.1226,1865.5,1435.1226,1861.5,1431.1226" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="71" x="1861.5" y="1413.3931">redis.get()</text><polygon fill="#000000" points="989.5,1472.7212,979.5,1476.7212,989.5,1480.7212,985.5,1476.7212" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1853.5" y1="1476.7212" y2="1476.7212"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="80" x="995.5" y="1456.1924">sessionData</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="245" x="995.5" y="1471.9917">(session info if valid, null if expired)</text><polygon fill="#000000" points="1842.5,1502.5205,1852.5,1506.5205,1842.5,1510.5205,1846.5,1506.5205" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1848.5" y1="1506.5205" y2="1506.5205"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="152" x="985.5" y="1501.791">getOTP(phoneOrEmail)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1854.5" x2="1896.5" y1="1536.3198" y2="1536.3198"/><line style="stroke:#000000;stroke-width:1.0;" x1="1896.5" x2="1896.5" y1="1536.3198" y2="1549.3198"/><line style="stroke:#000000;stroke-width:1.0;" x1="1855.5" x2="1896.5" y1="1549.3198" y2="1549.3198"/><polygon fill="#000000" points="1865.5,1545.3198,1855.5,1549.3198,1865.5,1553.3198,1861.5,1549.3198" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="71" x="1861.5" y="1531.5903">redis.get()</text><polygon fill="#000000" points="989.5,1590.9185,979.5,1594.9185,989.5,1598.9185,985.5,1594.9185" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1853.5" y1="1594.9185" y2="1594.9185"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62" x="995.5" y="1574.3896">savedOtp</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="228" x="995.5" y="1590.189">(OTP code if valid, null if expired)</text><path d="M25,1609.9185 L89,1609.9185 L89,1617.7178 L79,1627.7178 L25,1627.7178 L25,1609.9185 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="495.7563" style="stroke:#000000;stroke-width:1.0;" width="1934.5" x="25" y="1609.9185"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="40" y="1623.9883">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="70" x="104" y="1622.9775">[OTP valid]</text><polygon fill="#000000" points="1842.5,1645.5171,1852.5,1649.5171,1842.5,1653.5171,1846.5,1649.5171" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1848.5" y1="1649.5171" y2="1649.5171"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="222" x="985.5" y="1644.7876">updateSessionVerified(sessionId)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1854.5" x2="1896.5" y1="1679.3164" y2="1679.3164"/><line style="stroke:#000000;stroke-width:1.0;" x1="1896.5" x2="1896.5" y1="1679.3164" y2="1692.3164"/><line style="stroke:#000000;stroke-width:1.0;" x1="1855.5" x2="1896.5" y1="1692.3164" y2="1692.3164"/><polygon fill="#000000" points="1865.5,1688.3164,1855.5,1692.3164,1865.5,1696.3164,1861.5,1692.3164" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="86" x="1861.5" y="1674.5869">redis.setex()</text><polygon fill="#000000" points="989.5,1733.915,979.5,1737.915,989.5,1741.915,985.5,1737.915" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1853.5" y1="1737.915" y2="1737.915"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="51" x="995.5" y="1717.3862">success</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="193" x="995.5" y="1733.1855">(session marked as verified)</text><polygon fill="#000000" points="1842.5,1763.7144,1852.5,1767.7144,1842.5,1771.7144,1846.5,1767.7144" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1848.5" y1="1767.7144" y2="1767.7144"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="172" x="985.5" y="1762.9849">deleteOTP(phoneOrEmail)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1854.5" x2="1896.5" y1="1797.5137" y2="1797.5137"/><line style="stroke:#000000;stroke-width:1.0;" x1="1896.5" x2="1896.5" y1="1797.5137" y2="1810.5137"/><line style="stroke:#000000;stroke-width:1.0;" x1="1855.5" x2="1896.5" y1="1810.5137" y2="1810.5137"/><polygon fill="#000000" points="1865.5,1806.5137,1855.5,1810.5137,1865.5,1814.5137,1861.5,1810.5137" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="70" x="1861.5" y="1792.7842">redis.del()</text><polygon fill="#000000" points="989.5,1852.1123,979.5,1856.1123,989.5,1860.1123,985.5,1856.1123" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1853.5" y1="1856.1123" y2="1856.1123"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="51" x="995.5" y="1835.5835">success</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157" x="995.5" y="1851.3828">(OTP deleted after use)</text><polygon fill="#000000" points="691.5,1897.7109,681.5,1901.7109,691.5,1905.7109,687.5,1901.7109" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="685.5" x2="977.5" y1="1901.7109" y2="1901.7109"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="60" x="697.5" y="1881.1821">response</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="232" x="697.5" y="1896.9814">(verification success confirmation)</text><polygon fill="#000000" points="400.5,1943.3096,390.5,1947.3096,400.5,1951.3096,396.5,1947.3096" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394.5" x2="679.5" y1="1947.3096" y2="1947.3096"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="60" x="406.5" y="1926.7808">response</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151" x="406.5" y="1942.5801">(verified session data)</text><polygon fill="#000000" points="64.5,1973.1089,54.5,1977.1089,64.5,1981.1089,60.5,1977.1089" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58.5" x2="388.5" y1="1977.1089" y2="1977.1089"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="312" x="70.5" y="1972.3794">Display verification success, proceed to step 3</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="25" x2="1959.5" y1="1986.1089" y2="1986.1089"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="82" x="30" y="1997.168">[OTP invalid]</text><polygon fill="#000000" points="691.5,2018.2769,681.5,2022.2769,691.5,2026.2769,687.5,2022.2769" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="685.5" x2="977.5" y1="2022.2769" y2="2022.2769"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="197" x="697.5" y="2017.5474">throw BadRequestException()</text><polygon fill="#000000" points="400.5,2063.8755,390.5,2067.8755,400.5,2071.8755,396.5,2067.8755" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394.5" x2="679.5" y1="2067.8755" y2="2067.8755"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="34" x="406.5" y="2047.3467">error</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="240" x="406.5" y="2063.146">(OTP incorrect or expired message)</text><polygon fill="#000000" points="64.5,2093.6748,54.5,2097.6748,64.5,2101.6748,60.5,2097.6748" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58.5" x2="388.5" y1="2097.6748" y2="2097.6748"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="208" x="70.5" y="2092.9453">Display OTP incorrect message</text><polygon fill="#000000" points="377.5,2130.4741,387.5,2134.4741,377.5,2138.4741,381.5,2134.4741" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="53.5" x2="383.5" y1="2134.4741" y2="2134.4741"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="224" x="60.5" y="2129.7446">Enter personal info and password</text><polygon fill="#000000" points="668.5,2163.2734,678.5,2167.2734,668.5,2171.2734,672.5,2167.2734" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="389.5" x2="674.5" y1="2167.2734" y2="2167.2734"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="165" x="396.5" y="2162.5439">POST /register/complete</text><path d="M685,2147.4741 L685,2172.4741 L872,2172.4741 L872,2157.4741 L862,2147.4741 L685,2147.4741 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><path d="M862,2147.4741 L862,2157.4741 L872,2157.4741 L862,2147.4741 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="166" x="691" y="2165.5439">CompleteRegistrationDto</text><line style="stroke:#000000;stroke-width:1.0;" x1="680.5" x2="722.5" y1="2200.0728" y2="2200.0728"/><line style="stroke:#000000;stroke-width:1.0;" x1="722.5" x2="722.5" y1="2200.0728" y2="2213.0728"/><line style="stroke:#000000;stroke-width:1.0;" x1="681.5" x2="722.5" y1="2213.0728" y2="2213.0728"/><polygon fill="#000000" points="691.5,2209.0728,681.5,2213.0728,691.5,2217.0728,687.5,2213.0728" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="172" x="687.5" y="2195.3433">validateCompleteDto(dto)</text><polygon fill="#000000" points="966.5,2238.8721,976.5,2242.8721,966.5,2246.8721,970.5,2242.8721" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="680.5" x2="972.5" y1="2242.8721" y2="2242.8721"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="237" x="687.5" y="2238.1426">completeRegistration(completeDto)</text><polygon fill="#000000" points="1842.5,2268.6714,1852.5,2272.6714,1842.5,2276.6714,1846.5,2272.6714" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1848.5" y1="2272.6714" y2="2272.6714"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="177" x="985.5" y="2267.9419">getSessionData(sessionId)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1854.5" x2="1896.5" y1="2302.4707" y2="2302.4707"/><line style="stroke:#000000;stroke-width:1.0;" x1="1896.5" x2="1896.5" y1="2302.4707" y2="2315.4707"/><line style="stroke:#000000;stroke-width:1.0;" x1="1855.5" x2="1896.5" y1="2315.4707" y2="2315.4707"/><polygon fill="#000000" points="1865.5,2311.4707,1855.5,2315.4707,1865.5,2319.4707,1861.5,2315.4707" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="71" x="1861.5" y="2297.7412">redis.get()</text><polygon fill="#000000" points="989.5,2357.0693,979.5,2361.0693,989.5,2365.0693,985.5,2361.0693" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1853.5" y1="2361.0693" y2="2361.0693"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="80" x="995.5" y="2340.5405">sessionData</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151" x="995.5" y="2356.3398">(verified session data)</text><path d="M15,2376.0693 L79,2376.0693 L79,2383.8687 L69,2393.8687 L15,2393.8687 L15,2376.0693 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="1131.1113" style="stroke:#000000;stroke-width:1.0;" width="1938.5" x="15" y="2376.0693"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="30" y="2390.1392">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="173" x="94" y="2389.1284">[Session valid and verified]</text><polygon fill="#000000" points="1507.5,2411.668,1517.5,2415.668,1507.5,2419.668,1511.5,2415.668" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1513.5" y1="2415.668" y2="2415.668"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="203" x="985.5" y="2410.9385">checkCitizenIdExists(citizenId)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1519.5" x2="1561.5" y1="2445.4673" y2="2445.4673"/><line style="stroke:#000000;stroke-width:1.0;" x1="1561.5" x2="1561.5" y1="2445.4673" y2="2458.4673"/><line style="stroke:#000000;stroke-width:1.0;" x1="1520.5" x2="1561.5" y1="2458.4673" y2="2458.4673"/><polygon fill="#000000" points="1530.5,2454.4673,1520.5,2458.4673,1530.5,2462.4673,1526.5,2458.4673" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151" x="1526.5" y="2440.7378">prisma.auth.findFirst()</text><polygon fill="#000000" points="989.5,2500.0659,979.5,2504.0659,989.5,2508.0659,985.5,2504.0659" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1518.5" y1="2504.0659" y2="2504.0659"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82" x="995.5" y="2483.5371">existingAuth</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="215" x="995.5" y="2499.3364">(account with citizenId if exists)</text><path d="M25,2519.0659 L89,2519.0659 L89,2526.8652 L79,2536.8652 L25,2536.8652 L25,2519.0659 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="860.5488" style="stroke:#000000;stroke-width:1.0;" width="1918.5" x="25" y="2519.0659"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="40" y="2533.1357">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="135" x="104" y="2532.125">[CitizenId not exists]</text><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1020.5" y1="2558.6646" y2="2558.6646"/><line style="stroke:#000000;stroke-width:1.0;" x1="1020.5" x2="1020.5" y1="2558.6646" y2="2571.6646"/><line style="stroke:#000000;stroke-width:1.0;" x1="979.5" x2="1020.5" y1="2571.6646" y2="2571.6646"/><polygon fill="#000000" points="989.5,2567.6646,979.5,2571.6646,989.5,2575.6646,985.5,2571.6646" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169" x="985.5" y="2553.9351">hashPassword(password)</text><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1020.5" y1="2601.4639" y2="2601.4639"/><line style="stroke:#000000;stroke-width:1.0;" x1="1020.5" x2="1020.5" y1="2601.4639" y2="2614.4639"/><line style="stroke:#000000;stroke-width:1.0;" x1="979.5" x2="1020.5" y1="2614.4639" y2="2614.4639"/><polygon fill="#000000" points="989.5,2610.4639,979.5,2614.4639,989.5,2618.4639,985.5,2614.4639" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="125" x="985.5" y="2596.7344">beginTransaction()</text><polygon fill="#000000" points="1507.5,2640.2632,1517.5,2644.2632,1507.5,2648.2632,1511.5,2644.2632" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1513.5" y1="2644.2632" y2="2644.2632"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="234" x="985.5" y="2639.5337">createAccountRecord(accountData)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1519.5" x2="1561.5" y1="2674.0625" y2="2674.0625"/><line style="stroke:#000000;stroke-width:1.0;" x1="1561.5" x2="1561.5" y1="2674.0625" y2="2687.0625"/><line style="stroke:#000000;stroke-width:1.0;" x1="1520.5" x2="1561.5" y1="2687.0625" y2="2687.0625"/><polygon fill="#000000" points="1530.5,2683.0625,1520.5,2687.0625,1530.5,2691.0625,1526.5,2687.0625" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="139" x="1526.5" y="2669.333">prisma.auth.create()</text><polygon fill="#000000" points="989.5,2728.6611,979.5,2732.6611,989.5,2736.6611,985.5,2732.6611" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1518.5" y1="2732.6611" y2="2732.6611"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="29" x="995.5" y="2712.1323">auth</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="267" x="995.5" y="2727.9316">(new account with encrypted password)</text><polygon fill="#000000" points="1672.5,2758.4604,1682.5,2762.4604,1672.5,2766.4604,1676.5,2762.4604" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1678.5" y1="2762.4604" y2="2762.4604"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="223" x="985.5" y="2757.731">createPatientRecord(patientData)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1684.5" x2="1726.5" y1="2792.2598" y2="2792.2598"/><line style="stroke:#000000;stroke-width:1.0;" x1="1726.5" x2="1726.5" y1="2792.2598" y2="2805.2598"/><line style="stroke:#000000;stroke-width:1.0;" x1="1685.5" x2="1726.5" y1="2805.2598" y2="2805.2598"/><polygon fill="#000000" points="1695.5,2801.2598,1685.5,2805.2598,1695.5,2809.2598,1691.5,2805.2598" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="156" x="1691.5" y="2787.5303">prisma.patient.create()</text><polygon fill="#000000" points="989.5,2846.8584,979.5,2850.8584,989.5,2854.8584,985.5,2850.8584" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1683.5" y1="2850.8584" y2="2850.8584"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="46" x="995.5" y="2830.3296">patient</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="209" x="995.5" y="2846.1289">(new patient linked to account)</text><polygon fill="#000000" points="1842.5,2876.6577,1852.5,2880.6577,1842.5,2884.6577,1846.5,2880.6577" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1848.5" y1="2880.6577" y2="2880.6577"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="166" x="985.5" y="2875.9282">deleteSession(sessionId)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1854.5" x2="1896.5" y1="2910.457" y2="2910.457"/><line style="stroke:#000000;stroke-width:1.0;" x1="1896.5" x2="1896.5" y1="2910.457" y2="2923.457"/><line style="stroke:#000000;stroke-width:1.0;" x1="1855.5" x2="1896.5" y1="2923.457" y2="2923.457"/><polygon fill="#000000" points="1865.5,2919.457,1855.5,2923.457,1865.5,2927.457,1861.5,2923.457" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="70" x="1861.5" y="2905.7275">redis.del()</text><polygon fill="#000000" points="989.5,2965.0557,979.5,2969.0557,989.5,2973.0557,985.5,2969.0557" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1853.5" y1="2969.0557" y2="2969.0557"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="51" x="995.5" y="2948.5269">success</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="138" x="995.5" y="2964.3262">(session cleaned up)</text><polygon fill="#000000" points="1207.5,2994.855,1217.5,2998.855,1207.5,3002.855,1211.5,2998.855" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1213.5" y1="2998.855" y2="2998.855"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="217" x="985.5" y="2994.1255">sendWelcomeNotification(email)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1219.5" x2="1261.5" y1="3028.6543" y2="3028.6543"/><line style="stroke:#000000;stroke-width:1.0;" x1="1261.5" x2="1261.5" y1="3028.6543" y2="3041.6543"/><line style="stroke:#000000;stroke-width:1.0;" x1="1220.5" x2="1261.5" y1="3041.6543" y2="3041.6543"/><polygon fill="#000000" points="1230.5,3037.6543,1220.5,3041.6543,1230.5,3045.6543,1226.5,3041.6543" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="141" x="1226.5" y="3023.9248">emailProvider.send()</text><polygon fill="#000000" points="989.5,3083.2529,979.5,3087.2529,989.5,3091.2529,985.5,3087.2529" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="983.5" x2="1218.5" y1="3087.2529" y2="3087.2529"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="38" x="995.5" y="3066.7241">result</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="146" x="995.5" y="3082.5234">(welcome email sent)</text><line style="stroke:#000000;stroke-width:1.0;" x1="978.5" x2="1020.5" y1="3117.0522" y2="3117.0522"/><line style="stroke:#000000;stroke-width:1.0;" x1="1020.5" x2="1020.5" y1="3117.0522" y2="3130.0522"/><line style="stroke:#000000;stroke-width:1.0;" x1="979.5" x2="1020.5" y1="3130.0522" y2="3130.0522"/><polygon fill="#000000" points="989.5,3126.0522,979.5,3130.0522,989.5,3134.0522,985.5,3130.0522" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="139" x="985.5" y="3112.3228">commitTransaction()</text><polygon fill="#000000" points="691.5,3171.6509,681.5,3175.6509,691.5,3179.6509,687.5,3175.6509" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="685.5" x2="977.5" y1="3175.6509" y2="3175.6509"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="60" x="697.5" y="3155.1221">response</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="274" x="697.5" y="3170.9214">(registration complete with account info)</text><polygon fill="#000000" points="400.5,3217.2495,390.5,3221.2495,400.5,3225.2495,396.5,3221.2495" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394.5" x2="679.5" y1="3221.2495" y2="3221.2495"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="60" x="406.5" y="3200.7207">response</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="127" x="406.5" y="3216.52">(success message)</text><polygon fill="#000000" points="64.5,3247.0488,54.5,3251.0488,64.5,3255.0488,60.5,3251.0488" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58.5" x2="388.5" y1="3251.0488" y2="3251.0488"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="187" x="70.5" y="3246.3193">Display registration success</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="25" x2="1943.5" y1="3260.0488" y2="3260.0488"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="110" x="30" y="3271.1079">[CitizenId exists]</text><polygon fill="#000000" points="691.5,3292.2168,681.5,3296.2168,691.5,3300.2168,687.5,3296.2168" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="685.5" x2="977.5" y1="3296.2168" y2="3296.2168"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169" x="697.5" y="3291.4873">throw ConflictException()</text><polygon fill="#000000" points="400.5,3337.8154,390.5,3341.8154,400.5,3345.8154,396.5,3341.8154" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394.5" x2="679.5" y1="3341.8154" y2="3341.8154"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="34" x="406.5" y="3321.2866">error</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="267" x="406.5" y="3337.0859">(citizen ID already registered message)</text><polygon fill="#000000" points="64.5,3367.6147,54.5,3371.6147,64.5,3375.6147,60.5,3371.6147" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58.5" x2="388.5" y1="3371.6147" y2="3371.6147"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="261" x="70.5" y="3366.8853">Display ID already registered message</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="15" x2="1953.5" y1="3387.6147" y2="3387.6147"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="107" x="20" y="3398.6738">[Session invalid]</text><polygon fill="#000000" points="691.5,3419.7827,681.5,3423.7827,691.5,3427.7827,687.5,3423.7827" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="685.5" x2="977.5" y1="3423.7827" y2="3423.7827"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="197" x="697.5" y="3419.0532">throw BadRequestException()</text><polygon fill="#000000" points="400.5,3465.3813,390.5,3469.3813,400.5,3473.3813,396.5,3469.3813" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394.5" x2="679.5" y1="3469.3813" y2="3469.3813"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="34" x="406.5" y="3448.8525">error</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="248" x="406.5" y="3464.6519">(session expired or invalid message)</text><polygon fill="#000000" points="64.5,3495.1807,54.5,3499.1807,64.5,3503.1807,60.5,3499.1807" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58.5" x2="388.5" y1="3499.1807" y2="3499.1807"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="216" x="70.5" y="3494.4512">Display session invalid message</text><!--SRC=[jLPBR-Cs4BxhLqnpae5iiej5BpuKI6qPpQ6DOINRIozSQcmJaKYLfEsulxx3XrwHuYnsiHS1uho-6Sutd5_i7Yk4kcH29WdZLccuUZAehu0PU4g-geCic3x3rKehQL4MNh1AEFrfLSBL1dV2MDIBS516qyLO8qTz51ozU9EWjCAItwnYekoBibQKLwOlo5l17UU4o_hJk_PqpQp0UBfkJpTO21DYPiiaUO8Fly5g3Xabew7UAub0EQD3aQoSS367zKF-2BSwuhwbJ_qfaSeYQB7RspaqAIsjIXRHwCXAKJ2BFLbQM3KB2fivDFvovoxLdTeisJYLkpdmFVBdjGFre7rXiXTICcdTEvebTr6xri9Kx8OTxFvcAsIn4jhOrCj3H7JMGkxkIECVcR9GDX3R837N80zb2OgQG9-4mHcrG6d10xZr9G7AEYed09kOoGubQahruN5DuSRdEHeZbBmlUj9iEGV3ZerioInBJQDt3QOxzZRPihNIxWPl35fyILjP26WEd9CXvHRjVOW2JiBkuTElbP04lXRwxEn6K1pyVcMlgHBrDNp- -F6x892xVlXnT5VRFwWHVKpwZtXoSaB4ol_C0neFO-RbUIElp5gheoXGtpZTj1KthMKEfIKCvCGviq3ismfT4IMK3ChqmTAWHn3QlKMG1GI-22csfGXsMTJmvrCeiX6Aq3gJECYilOh06xAgbJJONU9z0KmMuElfV5Hqp7Rep1VUQZLb1KNidPNNUPh3KXWQREUH8mV0bwBVwFqc3y3iNgiJq5pRbeBRx8LZxR981pXGQwKTjqgDh3Yt9ASkwC4UGNfRFN4LUZMcN09S5VZMW3gY5jlp1xgomPJwueyVR3qrfe9mDAIEZKrwR1JYUF94sA6T933fZEX2kcayZrJfB7lN9kHMkP7aWSM9v2SKCGUBLy5VK_RRuZfIKagHewwIbmBw6UWKlS9WQXpgeXjlle82YtuLVc1oLKm_KniGEu_HyN1u5bYYnN41faAIxkKv5PnHjAthhuF1sHkK35Yuvs_ZOqJgALOsIS2xz9mASKsFc-98vbQ1Ut_XSyjQXr_8tkNqwVexApRuxm7DUuGDNhZI6hdrAq2u_ukq7HfTO6oDsYZ9oj3TRfhLp9YJqiLR7EQggjsT31YyY8TXfz2-H5DaRlH6TEOJ3bBUQVyaRhzn-PvPCKR0xalJQ3VjtYn22s75VqW8uXR4ctztD-yjGLxZuXhaN-dMPxSLzLxh5i5m3-esdZqp-tMysRIvujb0vIkLNZvg9Wsjrqqx-WYzTEari1ZNsWrovot2R3QYwOo3OTegX90i92hn18DaKN9zhXtlXr0xBEi6Iroc8vOw_7LOrb4vOedo8Pnr0oTA8wBu1wMGpu7V4UDhBBsf5tjcE6al3RvtPYqlaKaAVgXV1ushqDzO4almBsNRqHIsck_UYKx18tIxqIXVJzTAs76pJ4rctQDqo_Dmp-sYJyCdE9ZSc-8qxmsyYP4t21DD1ljanv4XFzvVeYQcSgGZt2_XyaOrWVIYJRTwUj1vktpyw3lIj5JpVD1B4frUV4dC4C3WBVaV]--></g></svg>